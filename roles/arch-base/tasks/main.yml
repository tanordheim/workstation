---

- name: Update pacman cache
  community.general.pacman:
    update_cache: yes
  become: true

- name: Install core packages
  community.general.pacman:
    name:
      - libxkbcommon
      - linux-headers
      - man-db
      - man-pages
      - openssh
      - pacman-contrib
      - reflector
      - sudo
      - usbutils
      - zsh
  become: true

- name: Create reflector config
  ansible.builtin.copy:
    src: reflector.conf
    dest: /etc/xdg/reflector/reflector.conf
    owner: root
    group: root
    mode: '0644'
  become: true

- name: Enable reflector to run on boot and weekly
  ansible.builtin.service:
    name: "{{ item }}"
    enabled: true
  become: true
  with_items: [reflector.service, reflector.timer]

- name: Enable paccache timer to clean up pacman cache
  ansible.builtin.service:
    name: paccache.timer
    enabled: true
  become: true

- include: user.yml
- include: locale.yml
- include: aur.yml
- include: timezone.yml
- include: audio.yml
